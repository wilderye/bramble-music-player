{"version":3,"file":"main.css","mappings":"AA8KA,wEAEE,wBACF,CACA,kEAEE,SAAU,CACV,0BACF;;ACyJA,oFAEE,8CAAkD,CAClD,gBAAiB,CACjB,SACF,CAEA,8EAEE,YAAa,CACb,SAAU,CACV,YAAa,CACb,2BACF;;AC+BA,oFAEE,8CACF,CAEA,wCACE,SAAU,CACV,0BACF,CAEA,sCACE,SAAU,CACV,0BACF,CAGA,wEAEE,wBACF,CACA,kEAEE,SAAU,CACV,0BACF,CAGA,wEAEE,4BACF,CACA,kEAEE,SACF;;ACvSA,0BACE,QAAW,uBAA0B,CACrC,IAAM,2BAA8B,CACtC,CAEA,gCACE,gDACF,CAGA,6BACE,KACE,SAAU,CACV,0BACF,CACA,GACE,SAAU,CACV,uBACF,CACF,CAEA,6BACE,SAAU,CACV,oEACF;;AC1CA,6BACE,KACE,SAAU,CACV,0BACF,CACA,GACE,SAAU,CACV,uBACF,CACF,CAEA,6BACE,SAAU,CACV,oEACF;;ACkBA,sCAEE,4FACF,CAEA,iBACE,SAAU,CACV,sCACF,CAEA,eACE,SAAU,CACV,sCACF","sources":["src://tavern_helper_template/src/å¼€åœºç™½å‰ç«¯/components/TrackInput.vue","src://tavern_helper_template/src/å¼€åœºç™½å‰ç«¯/components/PlaylistEditor.vue","src://tavern_helper_template/src/å¼€åœºç™½å‰ç«¯/views/Dashboard.vue","src://tavern_helper_template/src/å¼€åœºç™½å‰ç«¯/views/Home.vue","src://tavern_helper_template/src/å¼€åœºç™½å‰ç«¯/views/Setup.vue","src://tavern_helper_template/src/å¼€åœºç™½å‰ç«¯/app.vue"],"sourcesContent":["<template>\n  <div class=\"w-full space-y-6\">\n    <!-- 1. æ¨¡å¼åˆ‡æ¢ (Clean Segmented Control) -->\n    <div class=\"flex w-full rounded-2xl bg-stone-100 p-1.5 dark:bg-stone-800\">\n      <button\n        type=\"button\"\n        class=\"flex-1 rounded-xl py-3 text-base font-bold transition-all\"\n        :class=\"\n          mode === 'raw'\n            ? 'bg-white text-stone-800 shadow-sm dark:bg-stone-700 dark:text-stone-100'\n            : 'text-stone-500 hover:text-stone-700 dark:text-stone-400'\n        \"\n        @click=\"mode = 'raw'\"\n      >\n        <i class=\"fas fa-magic mr-2\"></i>\n        ç›´æ¥ç²˜è´´\n      </button>\n\n      <button\n        type=\"button\"\n        class=\"flex-1 rounded-xl py-3 text-base font-bold transition-all\"\n        :class=\"\n          mode === 'structured'\n            ? 'bg-white text-stone-800 shadow-sm dark:bg-stone-700 dark:text-stone-100'\n            : 'text-stone-500 hover:text-stone-700 dark:text-stone-400'\n        \"\n        @click=\"mode = 'structured'\"\n      >\n        <i class=\"fas fa-list-ul mr-2\"></i>\n        æ‰‹åŠ¨å½•å…¥\n      </button>\n    </div>\n\n    <!-- 2. æ¨¡å¼ A: Raw æ–‡æœ¬è¾“å…¥ -->\n    <div v-show=\"mode === 'raw'\" class=\"relative w-full\">\n      <textarea\n        v-model=\"rawText\"\n        class=\"min-h-[240px] w-full appearance-none rounded-2xl bg-stone-100 p-5 font-mono text-base text-stone-700 shadow-sm transition-all outline-none placeholder:text-stone-400 focus:bg-white focus:ring-4 focus:ring-[#5C7F67]/20 dark:bg-stone-800 dark:text-stone-200 dark:focus:bg-stone-800 dark:focus:ring-[#5C7F67]/30\"\n        placeholder=\"è¯·ç›´æ¥ç²˜è´´æ­Œæ›²ä¿¡æ¯ï¼Œå¸Œæœ›å±•ç¤ºçš„ä¿¡æ¯å®Œæ•´å³å¯ï¼Œå±Šæ—¶AIä¼šå¤„ç†å†…å®¹ã€‚&#10;ä¾‹å¦‚ï¼š&#10;1. æ­Œå - æ­Œæ‰‹ (https://example.com/1.mp3)&#10;2. æ­Œå https://example.com/2.mp3\"\n      ></textarea>\n\n      <div class=\"pointer-events-none absolute right-5 bottom-5 text-sm text-stone-400\">çº¯æ–‡æœ¬æ¨¡å¼</div>\n    </div>\n\n    <!-- 3. æ¨¡å¼ B: ç»“æ„åŒ–è¡¨å• -->\n    <div v-show=\"mode === 'structured'\" class=\"w-full space-y-6\">\n      <!-- ç©ºçŠ¶æ€ -->\n      <div\n        v-if=\"structuredList.length === 0\"\n        class=\"flex flex-col items-center justify-center rounded-3xl border-2 border-dashed border-stone-200 py-12 text-center dark:border-stone-700\"\n      >\n        <p class=\"mb-4 text-lg font-medium text-stone-500 dark:text-stone-400\">æš‚æ— æ­Œæ›²</p>\n        <button\n          type=\"button\"\n          class=\"rounded-full bg-stone-100 px-8 py-3 text-base font-bold text-stone-600 transition-all hover:-translate-y-0.5 hover:bg-[#5C7F67] hover:text-white hover:shadow-lg dark:bg-stone-800 dark:text-stone-300 dark:hover:bg-[#5C7F67]\"\n          @click=\"addTrack\"\n        >\n          <i class=\"fas fa-plus mr-2\"></i>\n          æ·»åŠ ç¬¬ä¸€é¦–æ­Œ\n        </button>\n      </div>\n\n      <!-- åˆ—è¡¨ -->\n      <div v-else class=\"space-y-6\">\n        <TransitionGroup name=\"list\">\n          <div\n            v-for=\"(track, index) in structuredList\"\n            :key=\"track.id\"\n            class=\"group relative w-full rounded-3xl bg-white p-6 shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all dark:bg-stone-800\"\n          >\n            <!-- åºå· -->\n            <div\n              class=\"absolute -top-3 -left-3 z-10 flex h-10 w-10 items-center justify-center rounded-full bg-white text-base font-bold text-stone-400 shadow-sm ring-4 ring-[#FDFCF8] dark:bg-stone-700 dark:text-stone-500 dark:ring-[#1c1917]\"\n            >\n              {{ index + 1 }}\n            </div>\n\n            <!-- åˆ é™¤æŒ‰é’® -->\n            <button\n              type=\"button\"\n              class=\"absolute top-4 right-4 rounded-full p-2 text-stone-300 opacity-0 transition-all group-hover:opacity-100 hover:bg-rose-50 hover:text-rose-500 dark:hover:bg-rose-900/20\"\n              @click=\"removeTrack(index)\"\n            >\n              <i class=\"fas fa-trash-alt text-lg\"></i>\n            </button>\n\n            <div class=\"grid gap-6 pt-2\">\n              <!-- URL -->\n              <div>\n                <label class=\"mb-2 block text-sm font-bold text-stone-600 dark:text-stone-300\">\n                  éŸ³é¢‘ç›´é“¾ <span class=\"text-rose-400\">*</span>\n                </label>\n                <input\n                  v-model=\"track.url\"\n                  type=\"text\"\n                  class=\"w-full appearance-none rounded-2xl bg-stone-50 px-5 py-4 text-base text-stone-800 transition-all outline-none placeholder:text-stone-400 focus:bg-white focus:ring-4 focus:ring-[#5C7F67]/20 dark:bg-stone-900 dark:text-stone-200 dark:focus:ring-[#5C7F67]/30\"\n                  placeholder=\"https://...\"\n                />\n              </div>\n\n              <!-- Title & Artist -->\n              <div class=\"grid grid-cols-2 gap-6\">\n                <div>\n                  <label class=\"mb-2 block text-sm font-bold text-stone-600 dark:text-stone-300\">æ­Œå</label>\n                  <input\n                    v-model=\"track.title\"\n                    type=\"text\"\n                    class=\"w-full appearance-none rounded-2xl bg-stone-50 px-5 py-4 text-base text-stone-800 transition-all outline-none placeholder:text-stone-400 focus:bg-white focus:ring-4 focus:ring-[#5C7F67]/20 dark:bg-stone-900 dark:text-stone-200 dark:focus:ring-[#5C7F67]/30\"\n                    placeholder=\"é€‰å¡«\"\n                  />\n                </div>\n                <div>\n                  <label class=\"mb-2 block text-sm font-bold text-stone-600 dark:text-stone-300\">æ­Œæ‰‹</label>\n                  <input\n                    v-model=\"track.artist\"\n                    type=\"text\"\n                    class=\"w-full appearance-none rounded-2xl bg-stone-50 px-5 py-4 text-base text-stone-800 transition-all outline-none placeholder:text-stone-400 focus:bg-white focus:ring-4 focus:ring-[#5C7F67]/20 dark:bg-stone-900 dark:text-stone-200 dark:focus:ring-[#5C7F67]/30\"\n                    placeholder=\"é€‰å¡«\"\n                  />\n                </div>\n              </div>\n\n              <!-- Cover -->\n              <div>\n                <label class=\"mb-2 block text-sm font-bold text-stone-600 dark:text-stone-300\">å°é¢å›¾ç‰‡é“¾æ¥</label>\n                <input\n                  v-model=\"track.cover\"\n                  type=\"text\"\n                  class=\"w-full appearance-none rounded-2xl bg-stone-50 px-5 py-4 text-base text-stone-800 transition-all outline-none placeholder:text-stone-400 focus:bg-white focus:ring-4 focus:ring-[#5C7F67]/20 dark:bg-stone-900 dark:text-stone-200 dark:focus:ring-[#5C7F67]/30\"\n                  placeholder=\"https://... (é€‰å¡«)\"\n                />\n              </div>\n            </div>\n          </div>\n        </TransitionGroup>\n\n        <!-- ç»§ç»­æ·»åŠ æŒ‰é’® -->\n        <button\n          type=\"button\"\n          class=\"flex w-full items-center justify-center gap-3 rounded-3xl border-2 border-dashed border-stone-200 py-5 text-base font-bold text-stone-400 transition-all hover:border-[#5C7F67]/50 hover:bg-[#5C7F67]/5 hover:text-[#5C7F67] dark:border-stone-700 dark:hover:border-[#5C7F67] dark:hover:bg-[#5C7F67]/10 dark:hover:text-[#5C7F67]\"\n          @click=\"addTrack\"\n        >\n          <i class=\"fas fa-plus\"></i>\n          ç»§ç»­æ·»åŠ \n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { StructuredTrack, TrackInputMode } from '../types';\nimport { generateUUID } from '../utils/id-generator';\n\nconst mode = defineModel<TrackInputMode>('mode', { required: true });\nconst rawText = defineModel<string>('raw', { required: true });\nconst structuredList = defineModel<StructuredTrack[]>('structured', { required: true });\n\nconst addTrack = () => {\n  structuredList.value.push({\n    id: generateUUID(),\n    url: '',\n    title: '',\n    artist: '',\n    cover: '',\n  });\n};\n\nconst removeTrack = (index: number) => {\n  structuredList.value.splice(index, 1);\n};\n</script>\n\n<style scoped>\n.list-enter-active,\n.list-leave-active {\n  transition: all 0.4s ease;\n}\n.list-enter-from,\n.list-leave-to {\n  opacity: 0;\n  transform: translateY(20px);\n}\n</style>\n","<template>\n  <div class=\"flex h-full w-full flex-col bg-[#FDFCF8] px-6 pb-32 dark:bg-[#1c1917]\">\n    <!-- 1. é¡¶éƒ¨å¯¼èˆª -->\n    <header class=\"flex w-full items-center py-6\">\n      <button\n        type=\"button\"\n        class=\"group flex items-center text-lg font-bold text-stone-500 transition-colors hover:text-stone-800 dark:text-stone-400 dark:hover:text-stone-200\"\n        @click=\"$emit('back')\"\n      >\n        <div\n          class=\"mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-stone-100 transition-colors group-hover:bg-stone-200 dark:bg-stone-800 dark:group-hover:bg-stone-700\"\n        >\n          <i class=\"fas fa-arrow-left text-sm\"></i>\n        </div>\n        <span>ä¿å­˜å¹¶è¿”å›</span>\n      </button>\n    </header>\n\n    <!-- 2. ä¸»è¡¨å•æµ -->\n    <main class=\"mx-auto w-full max-w-2xl space-y-12\">\n      <!-- æ ‡é¢˜åŒº -->\n      <h1 class=\"text-3xl font-bold text-stone-800 dark:text-stone-100\">\n        {{ playlist.id || 'ç¼–è¾‘æ­Œå•' }}\n      </h1>\n\n      <!-- Field 1: ID -->\n      <div>\n        <label class=\"mb-3 block text-lg font-bold text-stone-700 dark:text-stone-200\">\n          æ­Œå• ID <span class=\"text-rose-400\">*</span>\n        </label>\n        <input\n          v-model=\"playlist.id\"\n          type=\"text\"\n          class=\"w-full appearance-none rounded-2xl bg-stone-100 px-5 py-4 text-lg text-stone-800 transition-all outline-none placeholder:text-stone-400 focus:bg-white focus:ring-4 focus:ring-[#5C7F67]/20 dark:bg-stone-800 dark:text-stone-200 dark:focus:bg-stone-800 dark:focus:ring-[#5C7F67]/30\"\n          placeholder=\"ä¾‹å¦‚: battle_theme\"\n        />\n        <p class=\"mt-2 text-base text-stone-400\">å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¸å¯é‡å¤ã€‚</p>\n      </div>\n\n      <!-- Field 2: æ­Œå•ç±»å‹ -->\n      <div>\n        <label class=\"mb-3 block text-lg font-bold text-stone-700 dark:text-stone-200\"> æ­Œå•ç±»å‹ </label>\n        <div class=\"flex w-full rounded-2xl bg-stone-100 p-1.5 dark:bg-stone-800\">\n          <button\n            type=\"button\"\n            class=\"flex-1 rounded-xl py-3 text-base font-bold transition-all\"\n            :class=\"\n              currentType === 'base'\n                ? 'bg-white text-stone-800 shadow-sm dark:bg-stone-700 dark:text-stone-100'\n                : 'text-stone-500 hover:text-stone-700 dark:text-stone-400'\n            \"\n            @click=\"setPlaylistType('base')\"\n          >\n            åŸºç¡€æ­Œå•\n          </button>\n          <button\n            type=\"button\"\n            class=\"flex-1 rounded-xl py-3 text-base font-bold transition-all\"\n            :class=\"\n              currentType === 'scene'\n                ? 'bg-white text-stone-800 shadow-sm dark:bg-stone-700 dark:text-stone-100'\n                : 'text-stone-500 hover:text-stone-700 dark:text-stone-400'\n            \"\n            @click=\"setPlaylistType('scene')\"\n          >\n            åœºæ™¯æ­Œå•\n          </button>\n        </div>\n        <p class=\"mt-3 text-base text-stone-500\">\n          {{\n            currentType === 'base'\n              ? 'ä»å¼€åœºç™½å¼€å§‹æ— æ¡ä»¶æ’­æ”¾çš„æ­Œå•ï¼Œå¯ä½œä¸ºé»˜è®¤èƒŒæ™¯éŸ³ä¹ã€‚'\n              : 'æ ¹æ®ç‰¹å®šæ¡ä»¶è§¦å‘çš„æ­Œå•ï¼ˆå¦‚ä¸‹é›¨ã€æˆ˜æ–—ã€è¿›å…¥ç‰¹å®šåœ°ç‚¹ï¼‰ã€‚'\n          }}\n        </p>\n      </div>\n\n      <!-- Field 3: æ’­æ”¾æ¨¡å¼ -->\n      <div>\n        <label class=\"mb-3 block text-lg font-bold text-stone-700 dark:text-stone-200\"> æ’­æ”¾æ¨¡å¼ </label>\n        <div class=\"flex w-full max-w-md rounded-2xl bg-stone-100 p-1.5 dark:bg-stone-800\">\n          <button\n            type=\"button\"\n            class=\"flex-1 rounded-xl py-3 text-base font-bold transition-all\"\n            :class=\"\n              playlist.onFinishRule === 'loop'\n                ? 'bg-white text-stone-800 shadow-sm dark:bg-stone-700 dark:text-stone-100'\n                : 'text-stone-500 hover:text-stone-700 dark:text-stone-400'\n            \"\n            @click=\"playlist.onFinishRule = 'loop'\"\n          >\n            Loop (å¾ªç¯)\n          </button>\n          <button\n            type=\"button\"\n            class=\"flex-1 rounded-xl py-3 text-base font-bold transition-all\"\n            :class=\"\n              playlist.onFinishRule === 'pop'\n                ? 'bg-white text-stone-800 shadow-sm dark:bg-stone-700 dark:text-stone-100'\n                : 'text-stone-500 hover:text-stone-700 dark:text-stone-400'\n            \"\n            @click=\"playlist.onFinishRule = 'pop'\"\n          >\n            Pop (æ’­å®Œå³ç„š)\n          </button>\n</div>\n\n        <!-- [æ–°å¢] è§£é‡Šè¯´æ˜æ–‡æœ¬ -->\n        <!-- whitespace-pre-line ç”¨äºè¯†åˆ«æ–‡æ¡ˆä¸­çš„æ¢è¡Œç¬¦ \\n -->\n        <p class=\"mt-3 text-base whitespace-pre-line text-stone-500\">\n          {{ finishRuleDescription }}\n        </p>\n      </div>\n\n      <!-- Field 4: æ­Œæ›²åˆ—è¡¨ -->\n      <div>\n        <label class=\"mb-3 block text-lg font-bold text-stone-700 dark:text-stone-200\"> æ­Œæ›²åˆ—è¡¨ </label>\n        <TrackInput\n          v-model:mode=\"playlist.trackInputMode\"\n          v-model:raw=\"playlist.tracksRaw\"\n          v-model:structured=\"playlist.tracksStructured\"\n        />\n      </div>\n\n      <!-- Field 5: åœºæ™¯è§¦å‘é…ç½® (ä»… Scene æ˜¾ç¤º) -->\n      <Transition name=\"slide-down\">\n        <div v-if=\"currentType === 'scene'\" class=\"overflow-hidden\">\n          <!-- å®¹å™¨ï¼šæ·¡é›…å¤–æ¡† (Bg Stone 50 + Border Stone 200) -->\n          <div\n            class=\"rounded-3xl border border-stone-200 bg-stone-50/50 p-6 dark:border-stone-700 dark:bg-stone-800/30\"\n          >\n            <h3 class=\"mb-6 flex items-center text-xl font-bold text-[#5C7F67] dark:text-[#5C7F67]\">\n              <i class=\"fas fa-bolt mr-2\"></i>\n              è§¦å‘é…ç½®\n            </h3>\n\n            <!-- A. MVU æ¨¡å¼ -->\n            <div v-if=\"targetType === 'mvu'\" class=\"space-y-8\">\n              <!-- ä¼˜å…ˆçº§ -->\n              <div>\n                <label class=\"mb-3 block text-base font-bold text-stone-700 dark:text-stone-300\">\n                  ä¼˜å…ˆçº§ (Priority)\n                </label>\n                <div class=\"flex items-center gap-4\">\n                  <input\n                    v-model.number=\"playlist.mvuConfig.priority\"\n                    type=\"number\"\n                    class=\"w-28 appearance-none rounded-2xl bg-white px-4 py-3 text-center text-lg font-bold text-stone-800 shadow-sm transition-all outline-none focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-900 dark:text-stone-100\"\n                  />\n                  <span class=\"text-base text-stone-500\"\n                    >åœºæ™¯æ­Œå•çš„ä¼˜å…ˆçº§ã€‚å¤šä¸ªåœºæ™¯æ­Œå•æ»¡è¶³æ¡ä»¶æ—¶ï¼Œæ’­æ”¾ä¼˜å…ˆçº§æœ€é«˜çš„æ­Œæ›²ã€‚æ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</span\n                  >\n                </div>\n              </div>\n\n              <!-- è§¦å‘æ¡ä»¶åˆ—è¡¨ -->\n              <div>\n                <div class=\"mb-4 flex items-center justify-between\">\n                  <label class=\"text-base font-bold text-stone-700 dark:text-stone-300\"> æ¡ä»¶åˆ—è¡¨ (AND) </label>\n                  <button\n                    type=\"button\"\n                    class=\"rounded-lg px-3 py-1 text-sm font-bold text-[#5C7F67] hover:bg-[#5C7F67]/10 dark:hover:bg-[#5C7F67]/20\"\n                    @click=\"addMvuCondition\"\n                  >\n                    + æ·»åŠ æ¡ä»¶\n                  </button>\n                </div>\n\n                <div class=\"space-y-3\">\n                  <div\n                    v-for=\"(cond, idx) in playlist.mvuConfig.conditions\"\n                    :key=\"cond.id\"\n                    class=\"flex flex-wrap items-center gap-3 rounded-2xl bg-white p-3 shadow-sm transition-all hover:shadow-md dark:bg-stone-900\"\n                  >\n                    <!-- å˜é‡è·¯å¾„ -->\n                    <input\n                      v-model=\"cond.path\"\n                      type=\"text\"\n                      placeholder=\"å˜é‡è·¯å¾„\"\n                      class=\"min-w-[140px] flex-1 appearance-none rounded-xl bg-stone-50 px-4 py-3 text-base text-stone-800 outline-none placeholder:text-stone-400 focus:bg-white focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-800 dark:text-stone-200\"\n                    />\n\n                    <!-- æ“ä½œç¬¦ (å¸¦è‡ªå®šä¹‰ä¸‹æ‹‰å›¾æ ‡) -->\n                    <div class=\"relative\">\n                      <select\n                        v-model=\"cond.operator\"\n                        class=\"appearance-none rounded-xl bg-stone-50 py-3 pr-10 pl-4 text-base font-medium text-stone-800 outline-none focus:bg-white focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-800 dark:text-stone-200\"\n                      >\n                        <option>ç­‰äº</option>\n                        <option>å¤§äº</option>\n                        <option>å¤§äºç­‰äº</option>\n                        <option>å°äº</option>\n                        <option>å°äºç­‰äº</option>\n                        <option>å®ƒçš„æ–‡å­—åŒ…å«</option>\n                        <option>æ—¶é—´èŒƒå›´æ˜¯</option>\n                      </select>\n                      <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-stone-400\">\n                        <i class=\"fas fa-chevron-down text-xs\"></i>\n                      </div>\n                    </div>\n\n                    <!-- å€¼ -->\n                    <input\n                      v-model=\"cond.value\"\n                      type=\"text\"\n                      placeholder=\"å€¼\"\n                      class=\"min-w-[100px] flex-1 appearance-none rounded-xl bg-stone-50 px-4 py-3 text-base text-stone-800 outline-none placeholder:text-stone-400 focus:bg-white focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-800 dark:text-stone-200\"\n                    />\n\n                    <!-- åˆ é™¤ -->\n                    <button\n                      type=\"button\"\n                      class=\"px-3 text-stone-300 transition-colors hover:text-rose-400\"\n                      @click=\"removeMvuCondition(idx)\"\n                    >\n                      <i class=\"fas fa-times text-lg\"></i>\n                    </button>\n                  </div>\n                </div>\n              </div>\n\n              <!-- InitVar (å‚è€ƒ) -->\n              <div>\n                <label class=\"mb-3 block text-base font-bold text-stone-700 dark:text-stone-300\">\n                  InitVar å‚è€ƒ (é€‰å¡«)\n                </label>\n                <textarea\n                  v-model=\"playlist.mvuConfig.initVarRaw\"\n                  rows=\"3\"\n                  class=\"w-full appearance-none rounded-2xl bg-white px-5 py-4 text-base text-stone-600 shadow-sm transition-all outline-none placeholder:text-stone-300 focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-900 dark:text-stone-300\"\n                  placeholder=\"åœ¨æ­¤ç²˜è´´ InitVar å†…å®¹ï¼Œå¸®åŠ© AI ç†è§£å˜é‡ç»“æ„...\"\n                ></textarea>\n              </div>\n            </div>\n\n            <!-- B. Text æ¨¡å¼ -->\n            <div v-else class=\"space-y-4\">\n              <div>\n                <label class=\"mb-3 block text-xl font-bold text-stone-700 dark:text-stone-200\">\n                  åœºæ™¯æ­Œå•æ’­æ”¾æ¡ä»¶ <span class=\"text-rose-400\">*</span>\n                </label>\n                <textarea\n                  v-model=\"playlist.textConfig.sceneDescription\"\n                  rows=\"4\"\n                  class=\"w-full appearance-none rounded-2xl bg-white px-5 py-4 text-lg text-stone-700 shadow-sm transition-all outline-none placeholder:text-stone-300 focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-900 dark:text-stone-200\"\n                  placeholder=\"ä¾‹å¦‚ï¼š<user>è¿›å…¥/ä½äºå®¶ä¸­æ—¶ã€‚æ¡ä»¶æœ€å¥½æ¸…æ™°ã€æ˜ç¡®ï¼Œä¸å’Œå…¶ä»–æ­Œå•é‡å ã€‚\"\n                ></textarea>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Transition>\n      <!-- åº•éƒ¨ä¿å­˜æŒ‰é’® -->\n      <div class=\"mt-12 flex justify-center pb-8\">\n        <button\n          type=\"button\"\n          class=\"flex items-center rounded-full bg-[#6B8E78] px-10 py-3 text-lg font-bold text-white shadow-md transition-all hover:-translate-y-1 hover:bg-[#5C7F67] hover:shadow-lg active:translate-y-0 active:scale-95\"\n          @click=\"$emit('back')\"\n        >\n          <i class=\"fas fa-check mr-3\"></i>\n          ä¿å­˜\n        </button>\n      </div>\n    </main>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, watch } from 'vue';\nimport { MvuPlaylistType, Playlist, TargetType } from '../types';\nimport { generateUUID } from '../utils/id-generator';\nimport TrackInput from './TrackInput.vue';\n\nconst playlist = defineModel<Playlist>({ required: true });\n\ndefineProps<{\n  targetType: TargetType;\n  errors: Record<string, string>;\n}>();\n\ndefineEmits<{\n  (e: 'back'): void;\n}>();\n\n// --- Computed ---\nconst currentType = computed(() => playlist.value.mvuConfig.type);\n\n// [æ–°å¢] åŠ¨æ€è®¡ç®—æ’­æ”¾æ¨¡å¼çš„è§£é‡Šæ–‡æ¡ˆ\nconst finishRuleDescription = computed(() => {\n  const isBase = currentType.value === 'base';\n  const isLoop = playlist.value.onFinishRule === 'loop';\n\n  if (isBase) {\n    if (isLoop) return 'åªè¦æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„åœºæ™¯æ­Œå•ï¼Œåˆ™å¾ªç¯æ’­æ”¾åŸºç¡€æ­Œå•ã€‚';\n    return 'åªè¦æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„åœºæ™¯æ­Œå•ï¼Œåˆ™æ’­æ”¾åŸºç¡€æ­Œå•ï¼Œæ’­å®Œæ­Œå•ååœæ­¢æ’­æ”¾ã€‚';\n  } else {\n    // åœºæ™¯æ­Œå• (Scene)\n    if (isLoop) {\n      return 'å½“åœºæ™¯æ­Œå•æ»¡è¶³æ¡ä»¶æ—¶ï¼Œå¾ªç¯æ’­æ”¾ï¼Œç›´åˆ°ä¸å†æ»¡è¶³ã€‚\\næ­¤æ—¶å¦‚æœ‰æœªæ’­å®Œæˆ–loopæ¨¡å¼çš„åŸºç¡€æ­Œå•ï¼Œåˆ™æ’­æ”¾åŸºç¡€æ­Œå•ã€‚';\n    }\n    return 'å½“åœºæ™¯æ­Œå•æ»¡è¶³æ¡ä»¶æ—¶æ’­æ”¾ï¼Œç›´åˆ°æ’­å®Œä¸€æ¬¡æˆ–ä¸å†æ»¡è¶³æ¡ä»¶ã€‚\\næ­¤æ—¶å¦‚æœ‰æœªæ’­å®Œæˆ–loopæ¨¡å¼çš„åŸºç¡€æ­Œå•ï¼Œåˆ™æ’­æ”¾åŸºç¡€æ­Œå•ã€‚';\n  }\n});\n\n// --- Methods ---\nconst setPlaylistType = (type: MvuPlaylistType) => {\n  playlist.value.mvuConfig.type = type;\n};\n\nconst addMvuCondition = () => {\n  playlist.value.mvuConfig.conditions.push({\n    id: generateUUID(),\n    path: '',\n    operator: 'ç­‰äº',\n    value: '',\n  });\n};\n\nconst removeMvuCondition = (index: number) => {\n  playlist.value.mvuConfig.conditions.splice(index, 1);\n};\n\n// --- Watchers ---\n// å½“åˆ‡æ¢åˆ° 'scene' ä¸”æ²¡æœ‰æ¡ä»¶æ—¶ï¼Œè‡ªåŠ¨æ·»åŠ ä¸€æ¡ç©ºæ¡ä»¶\nwatch(\n  () => playlist.value.mvuConfig.type,\n  newType => {\n    if (newType === 'scene' && playlist.value.mvuConfig.conditions.length === 0) {\n      addMvuCondition();\n    }\n  },\n);\n</script>\n\n<style scoped>\n.slide-down-enter-active,\n.slide-down-leave-active {\n  transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);\n  max-height: 800px;\n  opacity: 1;\n}\n\n.slide-down-enter-from,\n.slide-down-leave-to {\n  max-height: 0;\n  opacity: 0;\n  margin-top: 0;\n  transform: translateY(-10px);\n}\n</style>\n","<template>\n  <div class=\"flex h-full w-full flex-col bg-[#FDFCF8] p-6 pb-20 dark:bg-[#1c1917]\">\n    <!-- 1. é¡¶éƒ¨å¯¼èˆª -->\n    <header class=\"flex w-full items-center justify-between py-4\">\n      <!-- å·¦ä¾§ï¼šè¿”å›é¦–é¡µ -->\n      <button\n        type=\"button\"\n        class=\"group flex items-center rounded-full px-4 py-2 text-sm font-bold text-stone-500 transition-all hover:bg-stone-100 hover:text-stone-800 dark:text-stone-400 dark:hover:bg-stone-800 dark:hover:text-stone-200\"\n        @click=\"$emit('navigate', 'home')\"\n      >\n        <div\n          class=\"mr-2 flex h-6 w-6 items-center justify-center rounded-full bg-stone-200 transition-colors group-hover:bg-stone-300 dark:bg-stone-700 dark:group-hover:bg-stone-600\"\n        >\n          <i class=\"fas fa-chevron-left text-[10px]\"></i>\n        </div>\n        è¿”å›é¦–é¡µ\n      </button>\n\n      <!-- å³ä¾§ï¼šæ¨¡å¼åˆ‡æ¢ -->\n      <div class=\"flex items-center gap-4\">\n        <!-- å½“å‰æ¨¡å¼æŒ‡ç¤º -->\n        <div class=\"hidden flex-col text-right sm:flex\">\n          <span class=\"text-xs font-bold tracking-wider text-stone-400 uppercase\">Current Mode</span>\n          <span class=\"text-sm font-bold text-[#5C7F67] dark:text-[#5C7F67]\">\n            {{ isMvu ? 'MVU å˜é‡å¡' : 'çº¯æ–‡å­— / ä¼ ç»Ÿå¡' }}\n          </span>\n        </div>\n\n        <button\n          type=\"button\"\n          class=\"flex items-center rounded-full bg-white px-4 py-2 text-sm font-bold text-stone-600 shadow-sm transition-all hover:bg-stone-50 hover:text-stone-900 active:scale-95 dark:bg-stone-800 dark:text-stone-300 dark:hover:bg-stone-700\"\n          @click=\"handleSwitchMode\"\n        >\n          <i class=\"fas fa-exchange-alt mr-2 text-xs\"></i>\n          åˆ‡æ¢æ¨¡å¼\n        </button>\n      </div>\n    </header>\n\n    <!-- 2. ä¸»å†…å®¹åŒº (è½¬åœºå®¹å™¨) -->\n    <main class=\"flex w-full flex-1 flex-col\">\n      <div class=\"mx-auto flex w-full max-w-3xl flex-1 flex-col\">\n        <Transition name=\"fade-slide\" mode=\"out-in\">\n          <!-- A. ç©ºçŠ¶æ€ (å‚ç›´å±…ä¸­) -->\n          <div\n            v-if=\"state.playlists.length === 0\"\n            key=\"empty\"\n            class=\"flex flex-1 flex-col items-center justify-center py-20\"\n          >\n            <div\n              class=\"mb-6 flex h-24 w-24 items-center justify-center rounded-full bg-[#5C7F67]/10 text-4xl text-[#5C7F67] dark:bg-[#5C7F67]/20\"\n            >\n              <i class=\"fas fa-music\"></i>\n            </div>\n            <p class=\"mb-8 text-lg font-medium text-stone-500 dark:text-stone-400\">è¿™é‡Œè¿˜å¾ˆå®‰é™ï¼Œå¼€å§‹æ·»åŠ ä¹ç« å§</p>\n            <button\n              type=\"button\"\n              class=\"flex items-center justify-center rounded-full bg-[#5C7F67] px-8 py-4 text-base font-bold text-white shadow-[0_10px_30px_-10px_rgba(92,127,103,0.4)] transition-all hover:-translate-y-1 hover:bg-[#4A6852] hover:shadow-[0_20px_40px_-10px_rgba(92,127,103,0.5)] active:translate-y-0 active:scale-95\"\n              @click=\"$emit('create')\"\n            >\n              <i class=\"fas fa-plus mr-2\"></i>\n              æ–°å»ºç¬¬ä¸€ä¸ªæ­Œå•\n            </button>\n          </div>\n\n          <!-- B. åˆ—è¡¨çŠ¶æ€ (åŒ…å«åº•éƒ¨é…ç½®) -->\n          <div v-else key=\"list\" class=\"flex flex-col\">\n            <!-- æ ‡é¢˜ -->\n            <h2 class=\"mb-6 ml-2 text-2xl font-bold text-stone-700 dark:text-stone-200\">\n              æ­Œå•åˆ—è¡¨\n              <span class=\"ml-2 text-base font-normal text-stone-400\">({{ state.playlists.length }})</span>\n            </h2>\n\n            <!-- æ­Œå•åˆ—è¡¨ -->\n            <div class=\"space-y-4\">\n              <TransitionGroup name=\"list\">\n                <div\n                  v-for=\"playlist in state.playlists\"\n                  :key=\"playlist._uuid\"\n                  class=\"group relative flex w-full cursor-pointer items-center justify-between rounded-3xl bg-white p-5 shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all dark:hover:bg-stone-750 hover:-translate-y-1 hover:shadow-[0_15px_30px_-5px_rgba(0,0,0,0.08)] dark:bg-stone-800 dark:shadow-none\"\n                  @click=\"$emit('edit', playlist._uuid)\"\n                >\n                  <!-- å·¦ä¾§ä¿¡æ¯ -->\n                  <div class=\"flex items-center gap-5\">\n                    <div\n                      class=\"flex h-12 w-12 items-center justify-center rounded-full transition-colors\"\n                      :class=\"getIconContainerClass(playlist)\"\n                    >\n                      <i :class=\"['fas', getIconClass(playlist)]\"></i>\n                    </div>\n\n                    <div class=\"flex flex-col\">\n                      <span class=\"text-lg font-bold text-stone-700 dark:text-stone-200\">\n                        {{ playlist.id || 'æœªå‘½åæ­Œå•' }}\n                      </span>\n                      <span class=\"text-sm text-stone-400\">\n                        {{ getPlaylistTypeLabel(playlist) }}\n                      </span>\n                    </div>\n                  </div>\n\n                  <!-- å³ä¾§åˆ é™¤ -->\n                  <button\n                    type=\"button\"\n                    class=\"rounded-full p-3 text-stone-300 opacity-0 transition-all group-hover:opacity-100 hover:bg-rose-50 hover:text-rose-500 dark:hover:bg-rose-900/20\"\n                    @click.stop=\"$emit('delete', playlist._uuid)\"\n                  >\n                    <i class=\"fas fa-trash-alt\"></i>\n                  </button>\n                </div>\n\n                <!-- åˆ—è¡¨æœ«å°¾çš„æ–°å»ºæŒ‰é’® -->\n                <button\n                  key=\"create-btn\"\n                  type=\"button\"\n                  class=\"flex w-full items-center justify-center rounded-3xl border-2 border-dashed border-stone-200 bg-transparent py-4 text-base font-bold text-stone-400 transition-all hover:border-[#5C7F67]/50 hover:bg-[#5C7F67]/5 hover:text-[#5C7F67] dark:border-stone-700 dark:hover:border-[#5C7F67] dark:hover:bg-[#5C7F67]/10 dark:hover:text-[#5C7F67]\"\n                  @click=\"$emit('create')\"\n                >\n                  <i class=\"fas fa-plus mr-2\"></i>\n                  æ–°å»ºæ­Œå•\n                </button>\n              </TransitionGroup>\n            </div>\n\n            <!-- C. å…¨å±€é…ç½®ä¸ç”Ÿæˆ -->\n            <div class=\"mt-32 flex flex-col items-center\">\n              <!-- å…¨å±€é…ç½®å¡ç‰‡ -->\n              <div\n                class=\"mb-8 w-full rounded-3xl bg-white p-8 shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] dark:bg-stone-800/50\"\n              >\n                <div class=\"mb-4 flex items-center gap-2\">\n                  <label class=\"text-lg font-bold text-stone-700 dark:text-stone-200\">\n                    é»˜è®¤èƒŒæ™¯éŸ³ä¹ (Default Playlist)\n                  </label>\n                  <button\n                    type=\"button\"\n                    class=\"text-stone-400 transition-colors hover:text-[#5C7F67]\"\n                    @click=\"showHelpModal = true\"\n                  >\n                    <i class=\"fas fa-question-circle text-lg\"></i>\n                  </button>\n                </div>\n\n                <div class=\"relative w-full max-w-md\">\n                  <select\n                    :value=\"state.defaultPlaylistId || ''\"\n                    class=\"w-full appearance-none rounded-2xl bg-stone-50 px-5 py-4 text-base text-stone-700 ring-1 ring-stone-200 transition-all outline-none focus:bg-white focus:ring-2 focus:ring-[#5C7F67]/30 dark:bg-stone-800 dark:text-stone-200 dark:ring-stone-700\"\n                    @change=\"onDefaultPlaylistChange\"\n                  >\n                    <option value=\"\">(æ— )</option>\n                    <option v-for=\"p in state.playlists\" :key=\"p._uuid\" :value=\"p.id\">\n                      {{ p.id || 'æœªå‘½åæ­Œå•' }}\n                    </option>\n                  </select>\n                  <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-5 text-stone-400\">\n                    <i class=\"fas fa-chevron-down text-xs\"></i>\n                  </div>\n                </div>\n                <p class=\"mt-3 text-sm text-stone-500\">åŸºç¡€æ­Œå•æ‰å¯ä»¥ä½œä¸ºé»˜è®¤æ­Œå•ã€‚</p>\n              </div>\n\n              <!-- ç”ŸæˆæŒ‰é’® (ç‚¹å‡»åå¼¹å‡ºç¡®è®¤æ¡†) -->\n              <button\n                type=\"button\"\n                class=\"w-fit rounded-full bg-[#5C7F67] px-16 py-4 text-xl font-bold text-white shadow-[0_10px_30px_-5px_rgba(92,127,103,0.4)] transition-all hover:-translate-y-1 hover:bg-[#4A6852] hover:shadow-[0_20px_40px_-5px_rgba(92,127,103,0.5)] active:translate-y-0 active:scale-95\"\n                @click=\"handleGenerateCheck\"\n              >\n                ç”Ÿæˆå¹¶å‘é€ç»™ AI\n                <i class=\"fas fa-paper-plane ml-3\"></i>\n              </button>\n            </div>\n          </div>\n        </Transition>\n      </div>\n    </main>\n\n    <!-- 3. å¸®åŠ©æ¨¡æ€çª— (Help Modal) -->\n    <Transition name=\"fade\">\n      <div\n        v-if=\"showHelpModal\"\n        class=\"fixed inset-0 z-50 flex items-center justify-center bg-stone-900/30 p-6 backdrop-blur-sm\"\n        @click.self=\"showHelpModal = false\"\n      >\n        <div class=\"w-full max-w-md scale-100 rounded-3xl bg-white p-8 shadow-2xl transition-all dark:bg-stone-800\">\n          <h3 class=\"mb-4 text-xl font-bold text-stone-800 dark:text-stone-100\">å…³äºé»˜è®¤èƒŒæ™¯éŸ³ä¹</h3>\n          <p class=\"mb-8 text-base leading-relaxed text-stone-600 dark:text-stone-300\">\n            å¿«é€Ÿç»™æ‰€æœ‰å¼€åœºç™½æŒ‡å®šé»˜è®¤åŸºç¡€æ­Œå•ï¼Œå¯åœ¨ç‰¹å®šå¼€åœºç™½ä½¿ç”¨&lt;playlist:...&gt;æ ‡ç­¾ä½¿ç”¨ç‰¹å®šæ­Œå•å–ä»£é»˜è®¤æ­Œå•ã€‚\n          </p>\n          <div class=\"flex justify-end\">\n            <button\n              type=\"button\"\n              class=\"rounded-full bg-[#5C7F67]/10 px-6 py-2 text-sm font-bold text-[#5C7F67] hover:bg-[#5C7F67]/20 dark:bg-[#5C7F67]/20 dark:text-[#5C7F67]\"\n              @click=\"showHelpModal = false\"\n            >\n              æˆ‘çŸ¥é“äº†\n            </button>\n          </div>\n        </div>\n      </div>\n    </Transition>\n\n    <!-- 4. å‘é€ç¡®è®¤æ¨¡æ€çª— (Confirmation Modal) -->\n    <Transition name=\"fade\">\n      <div\n        v-if=\"showConfirmModal\"\n        class=\"fixed inset-0 z-[60] flex items-center justify-center bg-stone-900/30 p-6 backdrop-blur-sm\"\n        @click.self=\"showConfirmModal = false\"\n      >\n        <div\n          class=\"relative w-full max-w-md scale-100 rounded-3xl bg-white p-8 shadow-2xl transition-all dark:bg-stone-800\"\n        >\n          <!-- å…³é—­æŒ‰é’® (å³ä¸Šè§’å° X) -->\n          <button\n            type=\"button\"\n            class=\"absolute top-4 right-4 p-2 text-stone-400 hover:text-stone-600 dark:hover:text-stone-200\"\n            @click=\"showConfirmModal = false\"\n          >\n            <i class=\"fas fa-times\"></i>\n          </button>\n\n          <!-- å†…å®¹ -->\n          <div class=\"flex flex-col items-center text-center\">\n            <!-- é—®å·å›¾æ ‡ -->\n            <div\n              class=\"mb-5 flex h-16 w-16 items-center justify-center rounded-full bg-[#5C7F67]/10 text-2xl text-[#5C7F67]\"\n            >\n              <i class=\"fas fa-paper-plane\"></i>\n            </div>\n\n            <h3 class=\"mb-4 text-xl font-bold text-stone-800 dark:text-stone-100\">æ˜¯å¦å‘é€ï¼Ÿ</h3>\n\n            <!-- æç¤ºæ–‡æœ¬ (ä¸»è¦å†…å®¹) -->\n            <p class=\"mb-8 text-base leading-relaxed text-stone-600 dark:text-stone-300\">\n              ğŸ’¡ å»ºè®®ä½¿ç”¨\n              <span class=\"font-bold text-[#5C7F67]\">Default</span> é¢„è®¾ï¼Œå¹¶å…³æ‰ä¸ç›¸å…³çš„ä¸–ç•Œä¹¦ï¼Œå¦åˆ™å¯èƒ½æŒ¤å  AI\n              æ³¨æ„åŠ›å¯¼è‡´ç”Ÿæˆé…ç½®å‡ºé”™å“¦ã€‚\n            </p>\n\n            <!-- æŒ‰é’®ç»„ -->\n            <div class=\"flex w-full gap-4\">\n              <!-- å–æ¶ˆæŒ‰é’® -->\n              <button\n                type=\"button\"\n                class=\"flex-1 rounded-full bg-stone-100 py-3 text-sm font-bold text-stone-600 transition-colors hover:bg-stone-200 dark:bg-stone-700 dark:text-stone-300 dark:hover:bg-stone-600\"\n                @click=\"showConfirmModal = false\"\n              >\n                å–æ¶ˆ\n              </button>\n\n              <!-- ç¡®è®¤æŒ‰é’® -->\n              <button\n                type=\"button\"\n                class=\"flex-1 rounded-full bg-[#5C7F67] py-3 text-sm font-bold text-white shadow-md transition-transform hover:scale-105 hover:bg-[#4A6852] active:scale-95\"\n                @click=\"confirmSend\"\n              >\n                ç¡®è®¤å‘é€\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue';\nimport { Playlist, ProjectState, ViewName } from '../types';\nimport { generatePrompt } from '../utils/prompt-generator';\nimport { validateGlobalState } from '../utils/validator';\n\n// --- ç±»å‹å£°æ˜ ---\ndeclare const toastr: any;\ndeclare function triggerSlash(content: string): void;\n\nconst props = defineProps<{\n  state: ProjectState;\n}>();\n\nconst emit = defineEmits<{\n  (e: 'navigate', view: ViewName): void;\n  (e: 'create'): void;\n  (e: 'edit', uuid: string): void;\n  (e: 'delete', uuid: string): void;\n  (e: 'update:default-playlist', id: string | null): void;\n}>();\n\n// --- Local State ---\nconst showHelpModal = ref(false);\nconst showConfirmModal = ref(false); // é‡å‘½åä¸º ConfirmModal\n\n// --- Computed ---\nconst isMvu = computed(() => props.state.targetType === 'mvu');\n\n// --- Helpers ---\nconst getIconContainerClass = (playlist: Playlist) => {\n  if (playlist.id === props.state.defaultPlaylistId) {\n    return 'bg-[#5C7F67]/10 text-[#5C7F67] dark:bg-[#5C7F67]/20';\n  }\n  return 'bg-stone-100 text-stone-400 dark:bg-stone-700 dark:text-stone-500';\n};\n\nconst getIconClass = (playlist: Playlist) => {\n  if (playlist.id === props.state.defaultPlaylistId) return 'fa-home';\n  if (isMvu.value && playlist.mvuConfig.type === 'scene') return 'fa-bolt';\n  return 'fa-music';\n};\n\nconst getPlaylistTypeLabel = (playlist: Playlist) => {\n  // æ— è®ºä½•ç§æ¨¡å¼ï¼Œéƒ½è¯»å–çœŸå®çš„ç±»å‹å­—æ®µ\n  return playlist.mvuConfig.type === 'base' ? 'åŸºç¡€æ­Œå•' : 'åœºæ™¯æ­Œå•';\n};\n\n// --- Handlers ---\nconst onDefaultPlaylistChange = (event: Event) => {\n  const val = (event.target as HTMLSelectElement).value;\n  emit('update:default-playlist', val || null);\n};\n\nconst handleSwitchMode = () => {\n  if (confirm('åˆ‡æ¢æ¨¡å¼å°†æ¸…ç©ºæ‰€æœ‰â€˜åœºæ™¯æ­Œå•â€™çš„è§¦å‘æ¡ä»¶é…ç½®ï¼ˆæ­Œæ›²åˆ—è¡¨ä¼šä¿ç•™ï¼‰ã€‚æ˜¯å¦ç»§ç»­ï¼Ÿ')) {\n    emit('navigate', 'setup');\n  }\n};\n\n/**\n * æ­¥éª¤ 1: æ ¡éªŒå¹¶å¼¹å‡ºç¡®è®¤æ¡†\n * æ›¿ä»£ä¹‹å‰çš„ handleGenerate\n */\nconst handleGenerateCheck = () => {\n  const result = validateGlobalState(props.state.playlists, props.state.targetType, props.state.defaultPlaylistId);\n\n  if (!result.passed) {\n    const errorMsg = `é…ç½®æ£€æŸ¥æœªé€šè¿‡ï¼š\\n\\n${result.messages.join('\\n')}`;\n    if (typeof toastr !== 'undefined') toastr.error('é…ç½®å­˜åœ¨é—®é¢˜', 'å‘é€ä¸­æ–­');\n    alert(errorMsg);\n    return;\n  }\n\n  // æ ¡éªŒé€šè¿‡ï¼Œæ‰“å¼€ç¡®è®¤å¼¹çª—\n  showConfirmModal.value = true;\n};\n\n/**\n * æ­¥éª¤ 2: ç¡®è®¤å‘é€\n * åœ¨ Modal ç‚¹å‡»â€œç¡®è®¤â€åè§¦å‘\n */\nconst confirmSend = () => {\n  const promptText = generatePrompt(props.state);\n\n  try {\n    const command = `/send ${promptText} | /trigger`;\n    if (typeof triggerSlash === 'function') {\n      triggerSlash(command);\n\n      // æˆåŠŸæç¤º (åˆå¹¶äº†ä¹‹å‰çš„ Wait æ–‡æœ¬)\n      if (typeof toastr !== 'undefined') {\n        toastr.success(\n          `å·²å°† ${props.state.playlists.length} ä¸ªæ­Œå•é…ç½®å‘é€ç»™ AIã€‚è¯·ç­‰å¾… AI å›å¤å’ŒæŒ‡å¯¼åç»­æ“ä½œã€‚`,\n          'å‘é€æˆåŠŸ',\n          { timeOut: 4000 } // åœç•™ 4s\n        );\n      }\n    } else {\n      console.error('triggerSlash not found');\n      alert('ç¯å¢ƒé”™è¯¯ï¼šæ— æ³•è°ƒç”¨ triggerSlashã€‚');\n    }\n  } catch (e) {\n    console.error(e);\n    alert('å‘é€æŒ‡ä»¤æ—¶å‘ç”Ÿæ„å¤–é”™è¯¯ã€‚');\n  } finally {\n    // æ— è®ºæˆåŠŸå¤±è´¥ï¼Œéƒ½å…³é—­å¼¹çª—\n    showConfirmModal.value = false;\n  }\n};\n</script>\n\n<style scoped>\n/* é¡µé¢è§†å›¾åˆ‡æ¢ */\n.fade-slide-enter-active,\n.fade-slide-leave-active {\n  transition: all 0.5s cubic-bezier(0.25, 1, 0.5, 1);\n}\n\n.fade-slide-enter-from {\n  opacity: 0;\n  transform: translateY(20px);\n}\n\n.fade-slide-leave-to {\n  opacity: 0;\n  transform: translateY(20px);\n}\n\n/* åˆ—è¡¨é¡¹å¢åˆ åŠ¨ç”» */\n.list-enter-active,\n.list-leave-active {\n  transition: all 0.4s ease;\n}\n.list-enter-from,\n.list-leave-to {\n  opacity: 0;\n  transform: translateY(20px);\n}\n\n/* Modal Fade */\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n</style>\n","<template>\n  <div class=\"flex h-full w-full flex-col items-center bg-[#FDFCF8] p-6 transition-colors duration-500 dark:bg-[#1c1917]\">\n\n    <!-- 1. æ ¸å¿ƒå†…å®¹åŒº (å‚ç›´å±…ä¸­ï¼Œé¿å…é¡¶å¤´) -->\n    <main class=\"flex w-full max-w-md flex-1 flex-col items-center justify-center\">\n\n      <!-- æ˜Ÿçƒå›¾æ ‡ (æ‚¬æµ®åŠ¨ç”»ï¼Œæ— åº•è‰²) -->\n      <div class=\"animate-float mb-8 text-7xl select-none\">\n        ğŸª\n      </div>\n\n      <!-- æ ‡é¢˜ç»„ -->\n      <div class=\"fade-in-up mb-12 text-center\" style=\"animation-delay: 100ms;\">\n        <h1 class=\"mb-3 text-3xl font-bold tracking-tight text-stone-700 dark:text-stone-200\">\n          æ¬¢è¿é™è½é»‘æ£˜æ˜Ÿ\n        </h1>\n        <p class=\"text-base text-stone-400 dark:text-stone-500\">\n          ä¸ºä½ çš„è§’è‰²å¡æ‰“é€ æ²‰æµ¸å¼å¬è§‰ä½“éªŒã€‚<br/>\n          è¯·é€‰æ‹©ä¸€ç§æ–¹å¼å¼€å§‹ä½ çš„æ—…ç¨‹ã€‚\n        </p>\n      </div>\n\n      <!-- åŠŸèƒ½å…¥å£å¡ç‰‡ç»„ (Action Tiles) -->\n      <div class=\"flex w-full flex-col gap-4\">\n\n        <!-- å¡ç‰‡ 1: ç®€å•å¼€å§‹ -->\n        <button\n          type=\"button\"\n          class=\"fade-in-up group relative flex w-full items-center gap-5 rounded-2xl bg-white p-5 text-left shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all hover:-translate-y-1 hover:shadow-[0_10px_30px_-4px_rgba(92,127,103,0.15)] dark:bg-stone-800 dark:shadow-none\"\n          style=\"animation-delay: 200ms;\"\n          title=\"è¯¥åŠŸèƒ½å³å°†ä¸Šçº¿\"\n        >\n          <!-- å›¾æ ‡å®¹å™¨ -->\n          <div class=\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-[#5C7F67]/10 text-[#5C7F67] transition-transform group-hover:scale-110 dark:bg-[#5C7F67]/20\">\n            <i class=\"fas fa-magic text-lg\"></i>\n          </div>\n          <!-- æ–‡å­— -->\n          <div class=\"flex flex-col\">\n            <span class=\"text-base font-bold text-stone-700 group-hover:text-[#5C7F67] dark:text-stone-200 dark:group-hover:text-[#5C7F67]\">\n              ç®€å•å¼€å§‹ç¬¬ä¸€æ­¥\n            </span>\n            <span class=\"text-xs text-stone-400\">\n              äº†è§£åŠŸèƒ½å’Œä½ çš„éœ€æ±‚ï¼Œåˆ¶ä½œç¬¬ä¸€ä¸ªæ­Œå•\n            </span>\n          </div>\n          <!-- ç®­å¤´ -->\n          <div class=\"ml-auto text-stone-300 transition-transform group-hover:translate-x-1 group-hover:text-[#5C7F67]\">\n            <i class=\"fas fa-chevron-right\"></i>\n          </div>\n        </button>\n\n        <!-- å¡ç‰‡ 2: æ‰¹é‡é…ç½® (åŸ Dashboard) -->\n        <button\n          type=\"button\"\n          class=\"fade-in-up group relative flex w-full items-center gap-5 rounded-2xl bg-white p-5 text-left shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all hover:-translate-y-1 hover:shadow-[0_10px_30px_-4px_rgba(92,127,103,0.15)] dark:bg-stone-800 dark:shadow-none\"\n          style=\"animation-delay: 300ms;\"\n          @click=\"$emit('start')\"\n        >\n          <div class=\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-[#5C7F67]/10 text-[#5C7F67] transition-transform group-hover:scale-110 dark:bg-[#5C7F67]/20\">\n            <i class=\"fas fa-layer-group text-lg\"></i>\n          </div>\n          <div class=\"flex flex-col\">\n            <span class=\"text-base font-bold text-stone-700 group-hover:text-[#5C7F67] dark:text-stone-200 dark:group-hover:text-[#5C7F67]\">\n              åˆ¶ä½œå¤šä¸ªæ­Œå•\n            </span>\n            <span class=\"text-xs text-stone-400\">\n              æ¸…æ¥šè‡ªèº«éœ€æ±‚åï¼Œæ›´å¿«æ·æ–¹ä¾¿åœ°åˆ¶ä½œæ­Œå•\n            </span>\n          </div>\n          <div class=\"ml-auto text-stone-300 transition-transform group-hover:translate-x-1 group-hover:text-[#5C7F67]\">\n            <i class=\"fas fa-chevron-right\"></i>\n          </div>\n        </button>\n\n        <!-- å¡ç‰‡ 3: çš®è‚¤åˆ¶ä½œ -->\n        <button\n          type=\"button\"\n          class=\"fade-in-up group relative flex w-full items-center gap-5 rounded-2xl bg-white p-5 text-left shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all hover:-translate-y-1 hover:shadow-[0_10px_30px_-4px_rgba(92,127,103,0.15)] dark:bg-stone-800 dark:shadow-none\"\n          style=\"animation-delay: 400ms;\"\n          title=\"è¯¥åŠŸèƒ½å³å°†ä¸Šçº¿\"\n        >\n          <div class=\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-[#5C7F67]/10 text-[#5C7F67] transition-transform group-hover:scale-110 dark:bg-[#5C7F67]/20\">\n            <i class=\"fas fa-paint-brush text-lg\"></i>\n          </div>\n          <div class=\"flex flex-col\">\n            <span class=\"text-base font-bold text-stone-700 group-hover:text-[#5C7F67] dark:text-stone-200 dark:group-hover:text-[#5C7F67]\">\n              åˆ¶ä½œæ’­æ”¾å™¨çš®è‚¤\n            </span>\n            <span class=\"text-xs text-stone-400\">\n              å®šåˆ¶è§’è‰²çš„ä¸“å±æ’­æ”¾å™¨\n            </span>\n          </div>\n          <div class=\"ml-auto text-stone-300 transition-transform group-hover:translate-x-1 group-hover:text-[#5C7F67]\">\n            <i class=\"fas fa-chevron-right\"></i>\n          </div>\n        </button>\n\n      </div>\n    </main>\n\n    <!-- 2. åº•éƒ¨ç‰ˆæƒ (æ²‰åº•ï¼Œä¸é‡å ) -->\n    <footer class=\"fade-in-up mt-auto pt-10 pb-2 text-center\" style=\"animation-delay: 600ms;\">\n      <p class=\"text-[10px] font-medium tracking-[0.2em] text-stone-300 uppercase dark:text-stone-700\">\n        Copyright Â© è’è¡Œ\n      </p>\n    </footer>\n\n  </div>\n</template>\n\n<script setup lang=\"ts\">\ndefineEmits<{\n  (e: 'start'): void\n}>();\n</script>\n\n<style scoped>\n/* æ˜Ÿçƒæ‚¬æµ®åŠ¨ç”» */\n@keyframes float {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-10px); }\n}\n\n.animate-float {\n  animation: float 4s ease-in-out infinite;\n}\n\n/* å…¥åœºæ·¡å…¥ä¸Šæµ®åŠ¨ç”» */\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.fade-in-up {\n  opacity: 0; /* åˆå§‹ä¸å¯è§ */\n  animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;\n}\n</style>\n","<template>\n  <div class=\"flex h-full w-full flex-col bg-[#FDFCF8] p-6 transition-colors duration-500 dark:bg-[#1c1917]\">\n\n    <!-- 1. é¡¶éƒ¨å¯¼èˆª -->\n    <header class=\"fade-in-up w-full py-4\" style=\"animation-delay: 0ms;\">\n      <button\n        type=\"button\"\n        class=\"group flex items-center rounded-full px-4 py-2 text-sm font-bold text-stone-500 transition-all hover:bg-stone-100 hover:text-stone-800 dark:text-stone-400 dark:hover:bg-stone-800 dark:hover:text-stone-200\"\n        @click=\"$emit('back')\"\n      >\n        <div class=\"mr-2 flex h-6 w-6 items-center justify-center rounded-full bg-stone-200 transition-colors group-hover:bg-stone-300 dark:bg-stone-700 dark:group-hover:bg-stone-600\">\n          <i class=\"fas fa-chevron-left text-[10px]\"></i>\n        </div>\n        è¿”å›\n      </button>\n    </header>\n\n    <!-- 2. æ ¸å¿ƒé€‰æ‹©åŒº -->\n    <main class=\"flex w-full flex-1 flex-col items-center justify-center pb-20\">\n\n      <!-- æ ‡é¢˜ç»„ -->\n      <div class=\"fade-in-up mb-12 text-center\" style=\"animation-delay: 100ms;\">\n        <h2 class=\"mb-3 text-2xl font-bold tracking-tight text-stone-700 dark:text-stone-200\">\n          é€‰æ‹©ä½ çš„è§’è‰²å¡ç±»å‹\n        </h2>\n        <p class=\"text-base text-stone-400 dark:text-stone-500\">\n          æˆ‘ä»¬å°†æ ¹æ®å¡ç‰‡ç±»å‹ï¼Œä¸ºä½ æä¾›æœ€åˆé€‚çš„é…ç½®å·¥å…·ã€‚\n        </p>\n      </div>\n\n      <!-- å¡ç‰‡ç½‘æ ¼ -->\n      <div class=\"grid w-full max-w-4xl gap-8 md:grid-cols-2\">\n\n        <!-- é€‰é¡¹ A: MVU å¡ -->\n        <button\n          type=\"button\"\n          class=\"fade-in-up group relative flex w-full flex-col items-center rounded-3xl bg-white p-10 text-center shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all hover:-translate-y-2 hover:shadow-[0_20px_40px_-4px_rgba(92,127,103,0.15)] dark:bg-stone-800 dark:shadow-none\"\n          style=\"animation-delay: 200ms;\"\n          @click=\"$emit('select', 'mvu')\"\n        >\n          <!-- å›¾æ ‡å®¹å™¨ -->\n          <div class=\"mb-8 flex h-24 w-24 items-center justify-center rounded-full bg-[#5C7F67]/10 text-4xl text-[#5C7F67] transition-transform duration-500 group-hover:scale-110 group-hover:rotate-6 dark:bg-[#5C7F67]/20\">\n            <i class=\"fas fa-bolt\"></i>\n          </div>\n\n          <!-- æ–‡æœ¬ -->\n          <h3 class=\"mb-3 text-xl font-bold text-stone-700 group-hover:text-[#5C7F67] dark:text-stone-200 dark:group-hover:text-[#5C7F67]\">\n            MVU å¡\n          </h3>\n          <p class=\"leading-relaxed text-stone-400 dark:text-stone-500\">\n            ä¸æ¶‰åŠ AI åˆ¤æ–­<br/>\n            å¯æ ¹æ®å˜é‡å˜åŒ–åˆ‡æ¢æ­Œå•\n          </p>\n\n          <!-- åº•éƒ¨è£…é¥°æ¡ (Hoveræ—¶æ˜¾ç°) -->\n          <div class=\"absolute bottom-0 h-1.5 w-1/3 rounded-t-full bg-[#5C7F67] opacity-0 transition-opacity duration-300 group-hover:opacity-100\"></div>\n        </button>\n\n        <!-- é€‰é¡¹ B: é MVU å¡ -->\n        <button\n          type=\"button\"\n          class=\"fade-in-up group relative flex w-full flex-col items-center rounded-3xl bg-white p-10 text-center shadow-[0_4px_20px_-4px_rgba(0,0,0,0.05)] transition-all hover:-translate-y-2 hover:shadow-[0_20px_40px_-4px_rgba(92,127,103,0.15)] dark:bg-stone-800 dark:shadow-none\"\n          style=\"animation-delay: 300ms;\"\n          @click=\"$emit('select', 'text')\"\n        >\n          <!-- å›¾æ ‡å®¹å™¨ -->\n          <div class=\"mb-8 flex h-24 w-24 items-center justify-center rounded-full bg-[#5C7F67]/10 text-4xl text-[#5C7F67] transition-transform duration-500 group-hover:scale-110 group-hover:-rotate-3 dark:bg-[#5C7F67]/20\">\n            <i class=\"fas fa-book-open\"></i>\n          </div>\n\n          <!-- æ–‡æœ¬ -->\n          <h3 class=\"mb-3 text-xl font-bold text-stone-700 group-hover:text-[#5C7F67] dark:text-stone-200 dark:group-hover:text-[#5C7F67]\">\n            é MVU å¡\n          </h3>\n          <p class=\"leading-relaxed text-stone-400 dark:text-stone-500\">\n            é€‚åˆè‡ªç„¶è¯­è¨€<br/>\n            ç”± AI åˆ¤æ–­åˆ‡æ¢æ­Œå•\n          </p>\n\n           <!-- åº•éƒ¨è£…é¥°æ¡ (Hoveræ—¶æ˜¾ç°) -->\n          <div class=\"absolute bottom-0 h-1.5 w-1/3 rounded-t-full bg-[#5C7F67] opacity-0 transition-opacity duration-300 group-hover:opacity-100\"></div>\n        </button>\n\n      </div>\n    </main>\n\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { TargetType } from '../types';\n\ndefineEmits<{\n  (e: 'back'): void;\n  (e: 'select', type: TargetType): void;\n}>();\n</script>\n\n<style scoped>\n/* å…¥åœºæ·¡å…¥ä¸Šæµ®åŠ¨ç”» */\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.fade-in-up {\n  opacity: 0;\n  animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;\n}\n</style>\n","<template>\n  <div class=\"flex min-h-[600px] w-full flex-col bg-[#FDFCF8] font-sans text-stone-600 transition-colors duration-500 dark:bg-[#1c1917] dark:text-stone-300\">\n\n    <!-- é¡µé¢è½¬åœºå®¹å™¨ -->\n    <Transition\n      name=\"page\"\n      mode=\"out-in\"\n    >\n      <!-- View 1: é¦–é¡µ -->\n      <Home\n        v-if=\"state.currentView === 'home'\"\n        key=\"home\"\n        @start=\"navigate('setup')\"\n      />\n\n      <!-- View 2: æ¨¡å¼é€‰æ‹© -->\n      <Setup\n        v-else-if=\"state.currentView === 'setup'\"\n        key=\"setup\"\n        @back=\"navigate('home')\"\n        @select=\"handleSetupComplete\"\n      />\n\n      <!-- View 3: ä»ªè¡¨ç›˜ (ç®¡ç†ä¸­å¿ƒ) -->\n      <Dashboard\n        v-else-if=\"state.currentView === 'dashboard'\"\n        key=\"dashboard\"\n        :state=\"state\"\n        @navigate=\"navigate\"\n        @create=\"createPlaylist\"\n        @edit=\"enterEditor\"\n        @delete=\"deletePlaylist\"\n        @update:default-playlist=\"updateDefaultPlaylist\"\n      />\n\n      <!-- View 4: ç¼–è¾‘å™¨ -->\n      <PlaylistEditor\n        v-else-if=\"state.currentView === 'editor'\"\n        key=\"editor\"\n        v-model=\"activePlaylist\"\n        :target-type=\"state.targetType\"\n        :errors=\"{}\"\n        @back=\"navigate('dashboard')\"\n      />\n    </Transition>\n\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, reactive, nextTick } from 'vue';\nimport { Playlist, ProjectState, TargetType, ViewName } from './types';\nimport { generateUUID } from './utils/id-generator';\n\nimport PlaylistEditor from './components/PlaylistEditor.vue';\nimport Dashboard from './views/Dashboard.vue';\nimport Home from './views/Home.vue';\nimport Setup from './views/Setup.vue';\n\n// --- å…¨å±€çŠ¶æ€åˆå§‹åŒ– ---\nconst state = reactive<ProjectState>({\n  currentView: 'home',\n  activePlaylistUuid: null,\n  targetType: 'mvu',\n  defaultPlaylistId: null,\n  playlists: [],\n});\n\n// --- Computed ---\nconst activePlaylist = computed({\n  get: () => state.playlists.find(p => p._uuid === state.activePlaylistUuid) as Playlist,\n  set: newVal => {\n    if (!newVal) return;\n    const idx = state.playlists.findIndex(p => p._uuid === newVal._uuid);\n    if (idx !== -1) state.playlists[idx] = newVal;\n  },\n});\n\n// --- Actions ---\nconst navigate = async (view: ViewName) => {\n  // 1. åˆ‡æ¢è§†å›¾\n  state.currentView = view;\n  if (view !== 'editor') state.activePlaylistUuid = null;\n\n  // 2. æ»šåŠ¨æ¡å¤ä½\n  // ä½¿ç”¨ nextTick ç¡®ä¿ DOM å·²ç»åˆ‡æ¢ä¸ºæ–°é¡µé¢åå†æ‰§è¡Œæ»šåŠ¨\n  await nextTick();\n  // å¼ºåˆ¶ç¬é—´å›é¡¶ï¼Œç§»é™¤ smooth ä»¥é¿å…é•¿çŸ­é¡µé¢åˆ‡æ¢æ—¶çš„è§†è§‰æ®‹ç•™\n  window.scrollTo(0, 0);\n};\n\nconst handleSetupComplete = (type: TargetType) => {\n  state.targetType = type;\n  // ç§»é™¤è‡ªåŠ¨åˆ›å»ºé€»è¾‘ï¼Œå…è®¸ç©ºåˆ—è¡¨\n  navigate('dashboard');\n};\n\nconst enterEditor = (uuid: string) => {\n  state.activePlaylistUuid = uuid;\n  navigate('editor');\n};\n\nconst createPlaylist = () => {\n  const newPlaylist: Playlist = {\n    _uuid: generateUUID(),\n    id: '',\n    onFinishRule: 'loop',\n    trackInputMode: 'raw',\n    tracksRaw: '',\n    tracksStructured: [],\n    // é»˜è®¤ç±»å‹ä¿®æ­£ä¸º 'base'\n    mvuConfig: { type: 'base', priority: 10, initVarRaw: '', conditions: [] },\n    textConfig: { sceneDescription: '' },\n  };\n  state.playlists.push(newPlaylist);\n};\n\nconst deletePlaylist = (uuid: string) => {\n  const idx = state.playlists.findIndex(p => p._uuid === uuid);\n  if (idx !== -1) {\n    if (state.playlists[idx].id === state.defaultPlaylistId) state.defaultPlaylistId = null;\n    state.playlists.splice(idx, 1);\n  }\n};\n\nconst updateDefaultPlaylist = (id: string | null) => {\n  state.defaultPlaylistId = id;\n};\n</script>\n\n<style>\n/* é¡µé¢è½¬åœºåŠ¨ç”»ï¼šæ·¡å…¥ä¸Šæµ® */\n.page-enter-active,\n.page-leave-active {\n  transition: opacity 0.5s cubic-bezier(0.25, 1, 0.5, 1), transform 0.5s cubic-bezier(0.25, 1, 0.5, 1);\n}\n\n.page-enter-from {\n  opacity: 0;\n  transform: translateY(15px) scale(0.98);\n}\n\n.page-leave-to {\n  opacity: 0;\n  transform: translateY(-5px) scale(0.98);\n}\n</style>\n"],"names":[],"ignoreList":[],"sourceRoot":""}