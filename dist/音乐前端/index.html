<head><script type="module">var e={441:(e,t)=>{t.A=(e,t)=>{const l=e.__vccOpts||e;for(const[e,a]of t)l[e]=a;return l}}},t={};const l=Vue,a=VueUse,o={class:'player-root'},n={class:'player-content-wrapper'},r={key:0,class:'player-main'},s={class:'track-info'},c=['src'],i={key:1,class:'cover-art cover-art-placeholder'},u={class:'details'},m=['title'],v=['title'],d={class:'controls'},p={class:'main-controls'},f=['title'],V={class:'volume-control-wrapper'},E={class:'playlist-drawer'},y={class:'playlist'},N=['title','onClick'],k={class:'index'},g={class:'title'},C={class:'artist'},b={class:'track'},B={key:1,class:'error-overlay'},h=(0,l.defineComponent)({__name:'app',setup(e){const t=(0,l.ref)(!1),h=(0,l.ref)(!1),w=(0,l.ref)(null),I=(0,l.ref)(null),P=(0,l.ref)(!1),x=e=>console.log(`[播放器前端] ${e}`),S=(0,l.ref)(null),M=(0,l.ref)(null),A=(0,l.ref)(!1),D=(0,l.ref)(!1),L=(0,l.ref)(!1),T=(0,l.ref)(null),F=(0,l.ref)([]),R=(0,l.ref)(.5),O=(0,l.ref)(-1),U=(0,l.ref)('list'),j=()=>{if(P.value)return P.value=!1,void x('“轻点”事件被抑制，因为它是一次长按的结束。');const e=['list','random','single'],t=e.indexOf(U.value),l=e[(t+1)%e.length];S.value?.setPlaybackMode(l)};(0,a.onLongPress)(I,()=>{t.value=!t.value,t.value&&(h.value=!1),x('长按触发：切换播放列表显示。'),P.value=!0,x('长按已处理，设置“轻点”抑制信号旗。')},{delay:400});const q=()=>{h.value=!h.value,h.value&&(t.value=!1)},Y=()=>{h.value&&(h.value=!1)},G=e=>{x('接收到完整状态更新'),D.value=e.isPlaying,L.value=e.isTransitioning,T.value=e.currentItem,F.value=e.playlist,R.value=e.masterVolume,U.value=e.playbackMode,e.currentItem?O.value=e.playlist.length>0?e.playlist.findIndex(t=>t.title===e.currentItem.title&&t.artist===e.currentItem.artist&&t.cover===e.currentItem.cover):-1:O.value=-1},H=()=>S.value?.togglePlayPause(),J=()=>S.value?.playNext(),K=()=>S.value?.playPrev(),Q=e=>{if(!w.value)return;const t=w.value.getBoundingClientRect(),l=t.bottom-e.clientY,a=Math.max(0,Math.min(1,l/t.height));R.value=a,S.value?.setLiveVolume(a)},W=e=>{Q(e)},X=()=>{document.removeEventListener('mousemove',W),document.removeEventListener('mouseup',X),S.value?.persistVolumeAndBroadcast(R.value)},Z=e=>{Q(e),document.addEventListener('mousemove',W),document.addEventListener('mouseup',X,{once:!0})};return(0,l.onMounted)(()=>{(async()=>{try{x('开始初始化流程... 界面当前为“隐身”状态。');const l=await(e='musicPlayerAPI',t=5e3,new Promise((l,a)=>{const o=Date.now(),n=setInterval(()=>{'object'==typeof top[e]&&null!==top[e]?(clearInterval(n),l(top[e])):Date.now()-o>t&&(clearInterval(n),a(new Error(`关键API对象 "${e}" 在 ${t/1e3} 秒内未出现。`)))},100)}));x('后台脚本API "musicPlayerAPI" 已就绪。'),await l.requestInitialization(),x('后台初始化请求已成功完成。'),S.value=l;const a=l.getCurrentState();G(a),l.onFullStateUpdate(G),x('初始化成功！界面已与后台同步。'),x('[幕启] 后台状态已同步，即将显示界面。'),A.value=!0}catch(e){x(`初始化流程失败: ${e}`),M.value=e instanceof Error?e.message:String(e),A.value=!0}var e,t})()}),(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createCommentVNode)(' [修改点] V9.1 - 新增根节点，用于解耦音量条与主容器的布局 '),(0,l.createElementVNode)('div',o,[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['aria-pod-container',{'is-ready':A.value,'is-playlist-open':t.value,'is-transitioning':L.value}]),onClick:Y},[(0,l.createElementVNode)('div',n,[(0,l.createCommentVNode)(' "Aria Pod" 主界面 '),M.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',r,[(0,l.createCommentVNode)(' 1. 当前曲目区 (Track Info) '),(0,l.createElementVNode)('div',s,[T.value?.cover?((0,l.openBlock)(),(0,l.createElementBlock)('img',{key:0,src:T.value.cover,alt:'封面',class:'cover-art'},null,8,c)):((0,l.openBlock)(),(0,l.createElementBlock)('div',i,[...a[1]||(a[1]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-music'},null,-1)])])),(0,l.createElementVNode)('div',u,[(0,l.createElementVNode)('p',{class:'title',title:T.value?.title},(0,l.toDisplayString)(T.value?.title||'歌单未配置'),9,m),(0,l.createElementVNode)('p',{class:'artist',title:T.value?.artist},(0,l.toDisplayString)(T.value?.artist||'未知艺术家'),9,v)])]),(0,l.createCommentVNode)(' 2. 核心控制区 (Playback Controls) '),(0,l.createElementVNode)('div',d,[(0,l.createElementVNode)('button',{ref_key:'modeButtonRef',ref:I,class:'control-btn',title:'切换播放模式 (轻点) / 打开列表 (长按)',onClick:(0,l.withModifiers)(j,['prevent'])},[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(['fa-solid',{'fa-list-ul':'list'===U.value,'fa-shuffle':'random'===U.value,'fa-repeat':'single'===U.value}])},null,2)],512),(0,l.createElementVNode)('div',p,[(0,l.createElementVNode)('button',{class:'control-btn',title:'上一首',onClick:K},[...a[2]||(a[2]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-backward-step'},null,-1)])]),(0,l.createElementVNode)('button',{class:'control-btn play-pause-btn',title:D.value?'暂停':'播放',onClick:H},[(0,l.createElementVNode)('i',{class:(0,l.normalizeClass)(D.value?'fa-solid fa-pause':'fa-solid fa-play')},null,2)],8,f),(0,l.createElementVNode)('button',{class:'control-btn',title:'下一首',onClick:J},[...a[3]||(a[3]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-forward-step'},null,-1)])])]),(0,l.createElementVNode)('div',V,[(0,l.createElementVNode)('button',{class:'control-btn volume-btn',title:'音量',onClick:(0,l.withModifiers)(q,['stop'])},[...a[4]||(a[4]=[(0,l.createElementVNode)('i',{class:'fa-solid fa-volume-high'},null,-1)])])])])])),(0,l.createCommentVNode)(' 3. 播放列表抽屉 (Playlist Drawer) '),(0,l.createElementVNode)('div',E,[(0,l.createElementVNode)('ul',y,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(F.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:`${e.title}-${t}`,class:(0,l.normalizeClass)({active:t===O.value}),title:`播放: ${e.title}`,onClick:e=>(e=>S.value?.playIndex(e))(t)},[(0,l.createElementVNode)('span',k,(0,l.toDisplayString)(t+1),1),(0,l.createElementVNode)('span',g,(0,l.toDisplayString)(e.title),1),(0,l.createElementVNode)('span',C,(0,l.toDisplayString)(e.artist),1)],10,N))),128))])])])],2),(0,l.createCommentVNode)(' [修改点] V9.1 - 音量滑块现在是根节点的子元素，与主容器是兄弟关系 '),h.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'volume-slider-container',onClick:a[0]||(a[0]=(0,l.withModifiers)(()=>{},['stop']))},[(0,l.createElementVNode)('div',{ref_key:'volumeTrackRef',ref:w,class:'custom-volume-slider',onMousedown:(0,l.withModifiers)(Z,['prevent','stop'])},[(0,l.createElementVNode)('div',b,[(0,l.createElementVNode)('div',{class:'progress',style:(0,l.normalizeStyle)({height:100*R.value+'%'})},null,4)]),(0,l.createElementVNode)('div',{class:'thumb',style:(0,l.normalizeStyle)({bottom:`calc(${100*R.value}% - 4px)`})},null,4)],544)])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' 初始化错误提示 (无变化) '),M.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',B,[a[5]||(a[5]=(0,l.createElementVNode)('p',null,[(0,l.createElementVNode)('i',{class:'fa-solid fa-triangle-exclamation'}),(0,l.createTextVNode)(' 播放器加载失败')],-1)),(0,l.createElementVNode)('small',null,(0,l.toDisplayString)(M.value),1)])):(0,l.createCommentVNode)('v-if',!0)])],2112))}});var w=function l(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,l),n.exports}(441);const I=(0,w.A)(h,[['__scopeId','data-v-4cac06d8']]);$(()=>{(0,l.createApp)(I).mount('#app')});
//# sourceMappingURL=index.js.map</script><style>.player-root[data-v-4cac06d8]{position:relative;width:300px;margin-left:auto}.aria-pod-container[data-v-4cac06d8]{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;color:#f2f2f7;width:100%;transition:height 0.35s cubic-bezier(0.4,0,0.2,1),opacity 0.25s ease-in-out;height:120px;box-sizing:border-box;opacity:0;pointer-events:none;position:relative;will-change:height}.aria-pod-container.is-ready[data-v-4cac06d8]{opacity:1;pointer-events:auto}.aria-pod-container.is-playlist-open[data-v-4cac06d8]{height:240px}.aria-pod-container.is-transitioning[data-v-4cac06d8]{opacity:0.7;pointer-events:none}.player-content-wrapper[data-v-4cac06d8]{background-color:#1c1c1e;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.5);padding:12px;width:100%;height:100%;box-sizing:border-box;display:flex;flex-direction:column;overflow:hidden;position:relative;z-index:1}.player-main[data-v-4cac06d8]{display:flex;flex-direction:column;gap:8px;flex-shrink:0}.track-info[data-v-4cac06d8]{display:flex;align-items:center;gap:12px;height:52px}.cover-art[data-v-4cac06d8]{width:52px;height:52px;border-radius:8px;object-fit:cover;flex-shrink:0}.cover-art-placeholder[data-v-4cac06d8]{display:flex;justify-content:center;align-items:center;background-color:#161618;font-size:22px;color:#8e8e93}.details[data-v-4cac06d8]{overflow:hidden;display:flex;flex-direction:column;justify-content:center}.details p[data-v-4cac06d8]{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.title[data-v-4cac06d8]{font-weight:600;font-size:16px;color:#ffffff}.artist[data-v-4cac06d8]{font-size:13px;color:#8e8e93}.controls[data-v-4cac06d8]{display:flex;justify-content:space-between;align-items:center}.main-controls[data-v-4cac06d8]{display:flex;align-items:center;gap:16px}.control-btn[data-v-4cac06d8]{background:none;border:none;color:#f2f2f7;cursor:pointer;border-radius:50%;display:flex;justify-content:center;align-items:center;transition:background-color 0.2s ease,transform 0.1s ease;font-size:15px;width:30px;height:30px}.control-btn[data-v-4cac06d8]:hover{background-color:rgba(255,255,255,0.1)}.control-btn[data-v-4cac06d8]:active{transform:scale(0.92);background-color:rgba(255,255,255,0.15)}.play-pause-btn[data-v-4cac06d8]{font-size:16px;width:36px;height:36px}.volume-control-wrapper[data-v-4cac06d8],.controls>.control-btn[data-v-4cac06d8]:first-child{width:30px}.volume-slider-container[data-v-4cac06d8]{position:absolute;bottom:40px;right:27px;transform:translateX(50%);animation:grow-up-4cac06d8 0.2s cubic-bezier(0.25,1,0.5,1);z-index:10;padding:10px 0;display:flex;justify-content:center}.custom-volume-slider[data-v-4cac06d8]{position:relative;width:24px;height:65px;cursor:pointer}.custom-volume-slider .track[data-v-4cac06d8]{position:absolute;top:0;left:50%;transform:translateX(-50%);width:6px;height:100%;background-color:#3a3a3c;border-radius:3px;overflow:hidden}.custom-volume-slider .progress[data-v-4cac06d8]{position:absolute;bottom:0;left:0;width:100%;background-color:#0a84ff;border-radius:3px}.custom-volume-slider .thumb[data-v-4cac06d8]{position:absolute;left:50%;transform:translateX(-50%);width:8px;height:8px;background-color:#ffffff;border-radius:50%;pointer-events:none;box-shadow:0 1px 3px rgba(0,0,0,0.3)}@keyframes grow-up-4cac06d8{from{opacity:0;transform:translateX(50%) scaleY(0.5);transform-origin:bottom}to{opacity:1;transform:translateX(50%) scaleY(1);transform-origin:bottom}}.playlist-drawer[data-v-4cac06d8]{flex-grow:1;overflow-y:auto;margin:4px -12px -12px;padding:4px 8px 12px 8px;scrollbar-width:thin;scrollbar-color:#8e8e93 #3a3a3c;transition:max-height 0.35s cubic-bezier(0.4,0,0.2,1),opacity 0.2s ease;max-height:0;opacity:0;visibility:hidden}.aria-pod-container.is-playlist-open .playlist-drawer[data-v-4cac06d8]{max-height:120px;opacity:1;visibility:visible}.playlist[data-v-4cac06d8]{list-style:none;padding:0;margin:0}.playlist li[data-v-4cac06d8]{display:grid;grid-template-columns:20px 1fr auto;gap:10px;align-items:center;padding:8px;border-radius:8px;cursor:pointer;font-size:14px;transition:background-color 0.2s;animation:fade-in-up-4cac06d8 0.3s ease-out both}.playlist li[data-v-4cac06d8]:nth-child(1){animation-delay:0.05s}.playlist li[data-v-4cac06d8]:nth-child(2){animation-delay:0.1s}.playlist li[data-v-4cac06d8]:nth-child(3){animation-delay:0.15s}.playlist li[data-v-4cac06d8]:nth-child(4){animation-delay:0.2s}.playlist li[data-v-4cac06d8]:nth-child(5){animation-delay:0.25s}@keyframes fade-in-up-4cac06d8{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.playlist li[data-v-4cac06d8]:hover{background-color:rgba(255,255,255,0.1)}.playlist li.active[data-v-4cac06d8]{background-color:#0a84ff;color:white}.playlist li.active .artist[data-v-4cac06d8],.playlist li.active .index[data-v-4cac06d8]{color:rgba(255,255,255,0.8)}.playlist li .index[data-v-4cac06d8]{color:#8e8e93;text-align:right;font-size:12px}.playlist li .artist[data-v-4cac06d8]{color:#8e8e93;text-align:right;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.error-overlay[data-v-4cac06d8]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;background-color:rgba(255,59,48,0.2);border:1px solid rgba(255,59,48,0.5);border-radius:12px;z-index:20}.error-overlay p[data-v-4cac06d8]{margin:0 0 5px 0}.error-overlay small[data-v-4cac06d8]{margin:0}


/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>