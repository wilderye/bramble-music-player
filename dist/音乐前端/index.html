<head><script type="module">import{Fragment as e,createApp as l,createCommentVNode as a,createElementBlock as t,createElementVNode as s,createTextVNode as n,defineComponent as o,normalizeClass as i,normalizeStyle as r,onMounted as u,openBlock as c,ref as v,renderList as d,toDisplayString as p,withModifiers as m}from'https://testingcf.jsdelivr.net/npm/vue/+esm';import{onLongPress as f}from'https://testingcf.jsdelivr.net/npm/@vueuse/core/+esm';var y={441:(e,l)=>{l.A=(e,l)=>{const a=e.__vccOpts||e;for(const[e,t]of l)a[e]=t;return a}}},k={};const g={class:'player-root'},b={class:'player-content-wrapper'},h={key:0,class:'player-main'},I={class:'track-info'},P=['src'],C={key:1,class:'cover-art cover-art-placeholder'},w={class:'details'},x=['title'],A=['title'],E={class:'controls'},V={class:'main-controls'},L=['title'],M={class:'volume-control-wrapper'},B={class:'playlist-drawer'},S={class:'playlist'},D=['title','onClick'],N={class:'index'},T={class:'title'},j={class:'artist'},R={class:'track'},F={key:1,class:'error-overlay'},O=o({__name:'app',setup(l){const o=v(!1),y=v(!1),k=v(null),O=v(null),q=v(!1),U=e=>console.log(`[播放器前端] ${e}`),Y=v(null),G=v(null),H=v(!1),J=v(!1),K=v(!1),Q=v(null),W=v([]),X=v(.5),Z=v(-1),ee=v('list'),le=()=>{if(q.value)return q.value=!1,void U('“轻点”事件被抑制，因为它是一次长按的结束。');const e=['list','random','single'],l=e.indexOf(ee.value),a=e[(l+1)%e.length];Y.value?.setPlaybackMode(a)};f(O,()=>{o.value=!o.value,o.value&&(y.value=!1),U('长按触发：切换播放列表显示。'),q.value=!0,U('长按已处理，设置“轻点”抑制信号旗。')},{delay:400});const ae=()=>{y.value=!y.value,y.value&&(o.value=!1)},te=()=>{y.value&&(y.value=!1)},se=e=>{U('接收到完整状态更新'),J.value=e.isPlaying,K.value=e.isTransitioning,Q.value=e.currentItem,W.value=e.playlist,X.value=e.masterVolume,ee.value=e.playbackMode,e.currentItem?Z.value=e.playlist.length>0?e.playlist.findIndex(l=>l.title===e.currentItem.title&&l.artist===e.currentItem.artist&&l.cover===e.currentItem.cover):-1:Z.value=-1},ne=()=>Y.value?.togglePlayPause(),oe=()=>Y.value?.playNext(),ie=()=>Y.value?.playPrev(),re=e=>{if(!k.value)return;const l=k.value.getBoundingClientRect(),a=l.bottom-e.clientY,t=Math.max(0,Math.min(1,a/l.height));X.value=t,Y.value?.setLiveVolume(t)},ue=e=>{re(e)},ce=()=>{document.removeEventListener('mousemove',ue),document.removeEventListener('mouseup',ce),Y.value?.persistVolumeAndBroadcast(X.value)},ve=e=>{re(e),document.addEventListener('mousemove',ue),document.addEventListener('mouseup',ce,{once:!0})};return u(()=>{(async()=>{try{U('开始初始化流程... 界面当前为“隐身”状态。');const a=await(e='musicPlayerAPI',l=5e3,new Promise((a,t)=>{const s=Date.now(),n=setInterval(()=>{'object'==typeof top[e]&&null!==top[e]?(clearInterval(n),a(top[e])):Date.now()-s>l&&(clearInterval(n),t(new Error(`关键API对象 "${e}" 在 ${l/1e3} 秒内未出现。`)))},100)}));U('后台脚本API "musicPlayerAPI" 已就绪。'),await a.requestInitialization(),U('后台初始化请求已成功完成。'),Y.value=a;const t=a.getCurrentState();se(t),a.onFullStateUpdate(se),U('初始化成功！界面已与后台同步。'),U('[幕启] 后台状态已同步，即将显示界面。'),H.value=!0}catch(e){U(`初始化流程失败: ${e}`),G.value=e instanceof Error?e.message:String(e),H.value=!0}var e,l})()}),(l,u)=>(c(),t(e,null,[a(' [修改点] V9.1 - 新增根节点，用于解耦音量条与主容器的布局 '),s('div',g,[s('div',{class:i(['aria-pod-container',{'is-ready':H.value,'is-playlist-open':o.value,'is-transitioning':K.value}]),onClick:te},[s('div',b,[a(' "Aria Pod" 主界面 '),G.value?a('v-if',!0):(c(),t('div',h,[a(' 1. 当前曲目区 (Track Info) '),s('div',I,[Q.value?.cover?(c(),t('img',{key:0,src:Q.value.cover,alt:'封面',class:'cover-art'},null,8,P)):(c(),t('div',C,[...u[1]||(u[1]=[s('i',{class:'fa-solid fa-music'},null,-1)])])),s('div',w,[s('p',{class:'title',title:Q.value?.title},p(Q.value?.title||'歌单未配置'),9,x),s('p',{class:'artist',title:Q.value?.artist},p(Q.value?.artist||'未知艺术家'),9,A)])]),a(' 2. 核心控制区 (Playback Controls) '),s('div',E,[s('button',{ref_key:'modeButtonRef',ref:O,class:'control-btn',title:'切换播放模式 (轻点) / 打开列表 (长按)',onClick:m(le,['prevent'])},[s('i',{class:i(['fa-solid',{'fa-list-ul':'list'===ee.value,'fa-shuffle':'random'===ee.value,'fa-repeat':'single'===ee.value}])},null,2)],512),s('div',V,[s('button',{class:'control-btn',title:'上一首',onClick:ie},[...u[2]||(u[2]=[s('i',{class:'fa-solid fa-backward-step'},null,-1)])]),s('button',{class:'control-btn play-pause-btn',title:J.value?'暂停':'播放',onClick:ne},[s('i',{class:i(J.value?'fa-solid fa-pause':'fa-solid fa-play')},null,2)],8,L),s('button',{class:'control-btn',title:'下一首',onClick:oe},[...u[3]||(u[3]=[s('i',{class:'fa-solid fa-forward-step'},null,-1)])])]),s('div',M,[s('button',{class:'control-btn volume-btn',title:'音量',onClick:m(ae,['stop'])},[...u[4]||(u[4]=[s('i',{class:'fa-solid fa-volume-high'},null,-1)])])])])])),a(' 3. 播放列表抽屉 (Playlist Drawer) '),s('div',B,[s('ul',S,[(c(!0),t(e,null,d(W.value,(e,l)=>(c(),t('li',{key:`${e.title}-${l}`,class:i({active:l===Z.value}),title:`播放: ${e.title}`,onClick:e=>(e=>Y.value?.playIndex(e))(l)},[s('span',N,p(l+1),1),s('span',T,p(e.title),1),s('span',j,p(e.artist),1)],10,D))),128))])])])],2),a(' [修改点] V9.1 - 音量滑块现在是根节点的子元素，与主容器是兄弟关系 '),y.value?(c(),t('div',{key:0,class:'volume-slider-container',onClick:u[0]||(u[0]=m(()=>{},['stop']))},[s('div',{ref_key:'volumeTrackRef',ref:k,class:'custom-volume-slider',onMousedown:m(ve,['prevent','stop'])},[s('div',R,[s('div',{class:'progress',style:r({height:100*X.value+'%'})},null,4)]),s('div',{class:'thumb',style:r({bottom:`calc(${100*X.value}% - 4px)`})},null,4)],544)])):a('v-if',!0),a(' 初始化错误提示 (无变化) '),G.value?(c(),t('div',F,[u[5]||(u[5]=s('p',null,[s('i',{class:'fa-solid fa-triangle-exclamation'}),n(' 播放器加载失败')],-1)),s('small',null,p(G.value),1)])):a('v-if',!0)])],2112))}});var q=function e(l){var a=k[l];if(void 0!==a)return a.exports;var t=k[l]={exports:{}};return y[l](t,t.exports,e),t.exports}(441);const U=(0,q.A)(O,[['__scopeId','data-v-4cac06d8']]);$(()=>{l(U).mount('#app')});
//# sourceMappingURL=index.js.map</script><style>.player-root[data-v-4cac06d8]{position:relative;width:300px;margin-left:auto}.aria-pod-container[data-v-4cac06d8]{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;color:#f2f2f7;width:100%;transition:height 0.35s cubic-bezier(0.4,0,0.2,1),opacity 0.25s ease-in-out;height:120px;box-sizing:border-box;opacity:0;pointer-events:none;position:relative;will-change:height}.aria-pod-container.is-ready[data-v-4cac06d8]{opacity:1;pointer-events:auto}.aria-pod-container.is-playlist-open[data-v-4cac06d8]{height:240px}.aria-pod-container.is-transitioning[data-v-4cac06d8]{opacity:0.7;pointer-events:none}.player-content-wrapper[data-v-4cac06d8]{background-color:#1c1c1e;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.5);padding:12px;width:100%;height:100%;box-sizing:border-box;display:flex;flex-direction:column;overflow:hidden;position:relative;z-index:1}.player-main[data-v-4cac06d8]{display:flex;flex-direction:column;gap:8px;flex-shrink:0}.track-info[data-v-4cac06d8]{display:flex;align-items:center;gap:12px;height:52px}.cover-art[data-v-4cac06d8]{width:52px;height:52px;border-radius:8px;object-fit:cover;flex-shrink:0}.cover-art-placeholder[data-v-4cac06d8]{display:flex;justify-content:center;align-items:center;background-color:#161618;font-size:22px;color:#8e8e93}.details[data-v-4cac06d8]{overflow:hidden;display:flex;flex-direction:column;justify-content:center}.details p[data-v-4cac06d8]{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.title[data-v-4cac06d8]{font-weight:600;font-size:16px;color:#ffffff}.artist[data-v-4cac06d8]{font-size:13px;color:#8e8e93}.controls[data-v-4cac06d8]{display:flex;justify-content:space-between;align-items:center}.main-controls[data-v-4cac06d8]{display:flex;align-items:center;gap:16px}.control-btn[data-v-4cac06d8]{background:none;border:none;color:#f2f2f7;cursor:pointer;border-radius:50%;display:flex;justify-content:center;align-items:center;transition:background-color 0.2s ease,transform 0.1s ease;font-size:15px;width:30px;height:30px}.control-btn[data-v-4cac06d8]:hover{background-color:rgba(255,255,255,0.1)}.control-btn[data-v-4cac06d8]:active{transform:scale(0.92);background-color:rgba(255,255,255,0.15)}.play-pause-btn[data-v-4cac06d8]{font-size:16px;width:36px;height:36px}.volume-control-wrapper[data-v-4cac06d8],.controls>.control-btn[data-v-4cac06d8]:first-child{width:30px}.volume-slider-container[data-v-4cac06d8]{position:absolute;bottom:40px;right:27px;transform:translateX(50%);animation:grow-up-4cac06d8 0.2s cubic-bezier(0.25,1,0.5,1);z-index:10;padding:10px 0;display:flex;justify-content:center}.custom-volume-slider[data-v-4cac06d8]{position:relative;width:24px;height:65px;cursor:pointer}.custom-volume-slider .track[data-v-4cac06d8]{position:absolute;top:0;left:50%;transform:translateX(-50%);width:6px;height:100%;background-color:#3a3a3c;border-radius:3px;overflow:hidden}.custom-volume-slider .progress[data-v-4cac06d8]{position:absolute;bottom:0;left:0;width:100%;background-color:#0a84ff;border-radius:3px}.custom-volume-slider .thumb[data-v-4cac06d8]{position:absolute;left:50%;transform:translateX(-50%);width:8px;height:8px;background-color:#ffffff;border-radius:50%;pointer-events:none;box-shadow:0 1px 3px rgba(0,0,0,0.3)}@keyframes grow-up-4cac06d8{from{opacity:0;transform:translateX(50%) scaleY(0.5);transform-origin:bottom}to{opacity:1;transform:translateX(50%) scaleY(1);transform-origin:bottom}}.playlist-drawer[data-v-4cac06d8]{flex-grow:1;overflow-y:auto;margin:4px -12px -12px;padding:4px 8px 12px 8px;scrollbar-width:thin;scrollbar-color:#8e8e93 #3a3a3c;transition:max-height 0.35s cubic-bezier(0.4,0,0.2,1),opacity 0.2s ease;max-height:0;opacity:0;visibility:hidden}.aria-pod-container.is-playlist-open .playlist-drawer[data-v-4cac06d8]{max-height:120px;opacity:1;visibility:visible}.playlist[data-v-4cac06d8]{list-style:none;padding:0;margin:0}.playlist li[data-v-4cac06d8]{display:grid;grid-template-columns:20px 1fr auto;gap:10px;align-items:center;padding:8px;border-radius:8px;cursor:pointer;font-size:14px;transition:background-color 0.2s;animation:fade-in-up-4cac06d8 0.3s ease-out both}.playlist li[data-v-4cac06d8]:nth-child(1){animation-delay:0.05s}.playlist li[data-v-4cac06d8]:nth-child(2){animation-delay:0.1s}.playlist li[data-v-4cac06d8]:nth-child(3){animation-delay:0.15s}.playlist li[data-v-4cac06d8]:nth-child(4){animation-delay:0.2s}.playlist li[data-v-4cac06d8]:nth-child(5){animation-delay:0.25s}@keyframes fade-in-up-4cac06d8{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.playlist li[data-v-4cac06d8]:hover{background-color:rgba(255,255,255,0.1)}.playlist li.active[data-v-4cac06d8]{background-color:#0a84ff;color:white}.playlist li.active .artist[data-v-4cac06d8],.playlist li.active .index[data-v-4cac06d8]{color:rgba(255,255,255,0.8)}.playlist li .index[data-v-4cac06d8]{color:#8e8e93;text-align:right;font-size:12px}.playlist li .artist[data-v-4cac06d8]{color:#8e8e93;text-align:right;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.error-overlay[data-v-4cac06d8]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;background-color:rgba(255,59,48,0.2);border:1px solid rgba(255,59,48,0.5);border-radius:12px;z-index:20}.error-overlay p[data-v-4cac06d8]{margin:0 0 5px 0}.error-overlay small[data-v-4cac06d8]{margin:0}


/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>